<script>
function expand_authors(id) {
  var authorShort = document.getElementById('author_' + id + '_short');
  var authorLong = document.getElementById('author_' + id + '_long');
  
  if (authorShort) {
    authorShort.classList.add('d-none');
    authorShort.classList.remove('d-inline');
  }
  if (authorLong) {
    authorLong.classList.add('d-inline');
    authorLong.classList.remove('d-none');
  }
}

function collapse_authors(id) {
  var authorShort = document.getElementById('author_' + id + '_short');
  var authorLong = document.getElementById('author_' + id + '_long');
  
  if (authorShort) {
    authorShort.classList.add('d-inline');
    authorShort.classList.remove('d-none');
  }
  if (authorLong) {
    authorLong.classList.add('d-none');
    authorLong.classList.remove('d-inline');
  }
}
  
function expand_abstract(id) {
  var abstractShort = document.getElementById('abstract_' + id + '_short');
  var abstractLong = document.getElementById('abstract_' + id + '_long');
  
  if (abstractShort) {
    abstractShort.classList.add('d-none');
    abstractShort.classList.remove('d-inline');
  }
  if (abstractLong) {
    abstractLong.classList.add('d-inline');
    abstractLong.classList.remove('d-none');
  }
}

function collapse_abstract(id) {
  var abstractShort = document.getElementById('abstract_' + id + '_short');
  var abstractLong = document.getElementById('abstract_' + id + '_long');
  
  if (abstractShort) {
    abstractShort.classList.add('d-inline');
    abstractShort.classList.remove('d-none');
  }
  if (abstractLong) {
    abstractLong.classList.add('d-none');
    abstractLong.classList.remove('d-inline');
  }
}

function expand_keywords(id) {
  var keywordShort = document.getElementById('keyword_' + id + '_short');
  var keywordLong = document.getElementById('keyword_' + id + '_long');
  
  if (keywordShort) {
    keywordShort.classList.add('d-none');
    keywordShort.classList.remove('d-inline');
  }
  if (keywordLong) {
    keywordLong.classList.add('d-inline');
    keywordLong.classList.remove('d-none');
  }
}

function collapse_keywords(id) {
  var keywordShort = document.getElementById('keyword_' + id + '_short');
  var keywordLong = document.getElementById('keyword_' + id + '_long');
  
  if (keywordShort) {
    keywordShort.classList.add('d-inline');
    keywordShort.classList.remove('d-none');
  }
  if (keywordLong) {
    keywordLong.classList.add('d-none');
    keywordLong.classList.remove('d-inline');
  }
}

function translate_title(paper_id) {
  var titleCn = document.getElementById('title_cn_' + paper_id);
  if (!titleCn) return;
  
  if (titleCn.innerHTML.trim() !== '') {
    if (titleCn.classList.contains('d-none')) {
      titleCn.classList.add('d-block');
      titleCn.classList.remove('d-none');
    } else {
      titleCn.classList.add('d-none');
      titleCn.classList.remove('d-block');
    }
  } else {
    titleCn.classList.add('d-block');
    titleCn.classList.remove('d-none');
    titleCn.innerHTML = '<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">Loading...</span></div>';
    ajaxPostJson({
      url: "{% url 'api:translate_title' %}",
      data: { paper_id: paper_id },
      success: function (data) {
        if (!data.success) {
          alert('Translate title failed!\n' + data.error);
        } else {
          titleCn.innerHTML = data.answer;
        }
      }
    });
  }
}

function translate_abstract(paper_id) {
  var abstractCn = document.getElementById('abstract_cn_' + paper_id);
  if (!abstractCn) return;
  
  if (abstractCn.innerHTML.trim() !== '') {
    if (abstractCn.classList.contains('d-none')) {
      abstractCn.classList.add('d-block');
      abstractCn.classList.remove('d-none');
    } else {
      abstractCn.classList.add('d-none');
      abstractCn.classList.remove('d-block');
    }
  } else {
    abstractCn.classList.add('d-block');
    abstractCn.classList.remove('d-none');
    abstractCn.innerHTML = '<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">Loading...</span></div>';
    ajaxPostJson({
      url: "{% url 'api:translate_abstract' %}",
      data: { paper_id: paper_id },
      success: function (data) {
        if (!data.success) {
          alert('Translate abstract failed!\n' + data.error);
        } else {
          abstractCn.innerHTML = data.answer;
        }
      }
    });
  }
}
</script>