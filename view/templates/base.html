<!DOCTYPE html>{% load static %}{% load view_extras %}{% load tz %}{% timezone "Asia/Shanghai" %}
<html>
<head>
  <meta charset="utf-8">
  <title>{{ site_name }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="CJeulU9yTowOBo-3EpJYEAhlHcG1NAHauYkG4LiIVQY" />
  <link rel="shortcut icon" type="image/x-icon" href="{% static 'favicon.ico' %}"/>
  <link rel="stylesheet" href="{% static 'styles.css' %}">{% block css %}{% endblock css %}
  {% include "sub/google-tag-manager-header.html" %}
</head>
<body>
  <a id="top"></a>
  <header>
    <div class="banner">
      <h1 class="logo"><a href="{% url 'view:index' %}">{{ site_name }}</a></h1>
      <div class="search-box">
        <form style="display:none;">
          <input id="search_text" class="search-input" type="text" value="{{ search_text }}"><input id="search_button" class="search-button" type="hidden" value="Search">
        </form>
      </div>
{% if user.is_authenticated or not request.path|is_for_xiangma %}
      <div class="login-panel">
        {% if user.is_authenticated %}
        {{ user }}
        <a href="{% url 'view:logout' %}">[Logout]</a>
        {% else %}
        <a href="{% url 'view:login' %}">[Login]</a>
        {% endif %}
      </div>
{% endif %}
    </div>
  </header>
  <div class="container">
    <nav class="menu">
{% if request.path|is_for_xiangma %}
      <a class="menu-item{% if current_page == "recent" %} current-item{% endif %}" href="{% url 'view:recent' %}">本月分享</a>
      <a class="menu-item{% if current_page == "all" %} current-item{% endif %}" href="{% url 'view:all' %}">所有分享</a>
      <a class="menu-item{% if current_page == "stat" %} current-item{% endif %}" href="{% url 'view:stat' %}">响马榜单</a>
{% else %}
      <a class="menu-item{% if current_page == "add" %} current-item{% endif %}" href="{% url 'view:add' %}">Add New</a>
  {% if user.is_authenticated %}
      <a class="menu-item{% if current_page == "all" %} current-item{% endif %}" href="{% url 'view:all' %}">All Papers</a>
      <a class="menu-item{% if current_page == "recent" %} current-item{% endif %}" href="{% url 'view:recent' %}">Recent</a>
      <a class="menu-item{% if current_page == "favor" %} current-item{% endif %}" href="{% url 'view:favor' %}">Favorites</a>
      <a class="menu-item{% if current_page == "trash" %} current-item{% endif %}" href="{% url 'view:trash' %}">Trash</a>
  {% endif %}
      <div class="menu-group">
        <div style="display:inline">Groups</div>
        <div style="display:inline; float:right"><a href="javascript:alert('add group');">+</a></div>
      </div>
      <div class="menu-group">
        <div style="display:inline">Searches</div>
        <div style="display:inline; float:right"><a href="javascript:alert('add search');">+</a></div>
      </div>
      <div class="menu-group">
        <div style="display:inline">Collections</div>
        <div style="display:inline; float:right"><a href="javascript:alert('add collection');">+</a></div>
      </div>
{% endif %}
    </nav>
    <div class="content">
      <article>
        {% if error_message %}<div id="error_message" class="error_message">{{ error_message }}<span class="close" onclick="this.parentElement.style.display = 'none';">x</span></div>{% endif %}
        {% block content %}{% endblock content %}
      </article>
    </div>
  </div>
  <footer>
    <p>&copy; <a href="https://yanlinlin.cn/" target="_blank">Linlin Yan</a>, 2022 | <a href="http://beian.miit.gov.cn/" target="_blank">京ICP备18031542号-9</a> | Powered by <a href="https://www.djangoproject.com/" target="_blank">Django</a></p>
  </footer>
  {% block javascript %}{% endblock javascript %}
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-1JBLE3S3G0"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-1JBLE3S3G0');
  </script>
  <script>
    window.onload = function() {
        var links = document.getElementsByTagName('a');
        for (var i in links) {
            if (links[i].nodeType != 1) continue;
            console.log(links[i].hostname);
            if (links[i].hostname != '' && links[i].hostname != window.location.hostname) {
                links[i].className += 'external';
                links[i].setAttribute('target', '_blank');
            }
        }
    }
    </script>
</body>
{% include "sub/google-tag-manager-header.html" %}
{% endtimezone %}</html>
